#!/bin/sh
bold="$(tput bold)"
normal="$(tput sgr0)"
envyml="${1:-environment.yml}"
if [ ! -f "$envyml" ]; then
    echo "âŒ  Environment file ${envyml} not found, aborting."
    exit 1
fi
pth_contents="${root}/paulssonlab/src"
pth_file="$(python -c 'import site; print(site.getsitepackages()[0])')/paulssonlab.pth"
echo "ðŸ“¦  ${bold}Adding paulssonlab package to PYTHONPATH: ${normal}writing \"${pth_contents}\" to $pth_file"
echo "$pth_contents" > "$pth_file"
labextensions=""
if grep -q "dask\|ipywidgets\|bokeh" "$envyml"; then
    labextensions="${labextensions} @jupyter-widgets/jupyterlab-manager"
fi
if grep -q "bokeh" "$envyml"; then
    labextensions="${labextensions} @bokeh/jupyter_bokeh"
fi
if grep -q "holoviews" "$envyml"; then
    labextensions="${labextensions} @pyviz/jupyterlab_pyviz"
fi
if [ -n "$labextensions" ]; then
    echo "ðŸ§ª  ${bold}Installing JupyterLab extensions:${normal}${labextensions}"
    jupyter labextension install${labextensions}
fi
